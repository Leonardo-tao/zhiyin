(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c8651"],{"13d7":function(e,t,i){},"3ddd":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"course",staticStyle:{position:"relative"}},[t("el-col",{staticStyle:{position:"relative"},attrs:{span:17}},[t("div",{staticStyle:{"padding-top":"56.25%"}}),t("div",{staticClass:"player"},[t("div",{staticClass:"preplay"},[t("div",{staticClass:"fade"}),t("i",{staticClass:"el-icon-video-play trnfcenter play-btn",on:{click:e.playFirst}}),t("el-image",{staticClass:"img",attrs:{fit:"cover",src:e.encodeOssFileUri(e.course.cover)}})],1),t("div",{attrs:{id:"J_prismPlayer"},on:{dblclick:e.requestFullScreen,contextmenu:function(t){return t.preventDefault(),e.requestPlay.apply(null,arguments)}}})])]),t("el-col",{key:e.refreshKey,staticClass:"selection",attrs:{span:7}},e._l(e.chapterData,(function(i){return t("div",{key:i.id,staticClass:"chapter"},[t("div",{staticClass:"title ellipse",attrs:{title:i.title}},[e._v(e._s(i.title))]),e._l(e.videoData[i.id],(function(s){return t("div",{key:`${i.id}:${s.id}`,class:{video:!0,active:e.activeItem===`${i.id}:${s.id}`},on:{click:function(t){return e.clickChapterItem(s,`${i.id}:${s.id}`)}}},[t("div",{staticClass:"title ellipse",attrs:{title:s.title}},[t("i",{staticClass:"el-icon-video-play"}),e._v(" "+e._s(s.title)+" ")]),t("div",{staticClass:"info"},[t("span",{staticClass:"duration"},[e._v("时长: "+e._s(s.duration))]),e.course.price>0&&s.free?t("span",{staticClass:"free"},[e._v("免费")]):e._e()])])}))],2)})),0)],1)},a=[],l=i("cc48"),r=i("2f62"),c=i("ed08"),n={name:"EducourseWatch",data(){return{course:{cover:"",price:0},player:null,chapterData:[],videoData:{},refreshKey:!1,activeItem:""}},computed:{...Object(r["b"])(["user"])},created(){this.$notify.info({title:"提示",dangerouslyUseHTMLString:!0,message:"鼠标左键双击播放器进入或退出全屏<br>鼠标右键单击播放器切换暂停与播放",offset:50,duration:3600})},methods:{setData(e){this.course=e,this.listChaptersAndVideos(e.id)},encodeOssFileUri(e){return Object(c["a"])(e)},listChaptersAndVideos(e){Object(l["d"])(e).then(e=>{this.chapterData=e.data;let t=e.data.length;for(const i of e.data)Object(l["c"])(i.id).then(e=>{this.videoData[i.id]=e.data,--t<=0&&(this.refreshKey=!this.refreshKey)})})},clickChapterItem(e,t){null!==this.user&&0!==Object.keys(this.user).length?(this.activeItem=t,this.play(e)):this.$login()},play(e){const t={courseId:e.courseId,videoId:e.id,videoSourceId:e.videoId};if(this.player)this.player.dispose(),this.player=null,document.getElementById("J_prismPlayer").innerHTML="",this.initPlayer(t);else{const e=document.querySelector(".player .preplay");e&&e.parentNode.removeChild(e),this.initPlayer(t)}},playFirst(){if(null!==this.user&&0!==Object.keys(this.user).length)try{const e=this.chapterData[0].id,t=this.videoData[e][0];this.play(t),setTimeout(function(){this.player.play()}.bind(this),1e3),this.activeItem=`${e}:${t.id}`}catch(e){console.log(e)}else this.$login()},initPlayer(e={courseId:0,videoId:0,videoSourceId:""}){Object(l["m"])(Object(c["c"])(e)).then(t=>{this.player=new Aliplayer({id:"J_prismPlayer",autoplay:!1,width:"100%",height:"100%",vid:e.videoSourceId,playauth:t.data})}).catch(e=>{console.log(e)})},requestFullScreen(){this.player&&(this.player.fullscreenService.getIsFullScreen()?this.player.fullscreenService.cancelFullScreen():this.player.fullscreenService.requestFullScreen())},requestPlay(){if(this.player){const e=this.player.getStatus();"playing"===e?this.player.pause():this.player.play()}}}},d=n,o=(i("fbdd"),i("2877")),u=Object(o["a"])(d,s,a,!1,null,"41c4e893",null);t["default"]=u.exports},fbdd:function(e,t,i){"use strict";i("13d7")}}]);